% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/AWRcca.R
\name{AWRcca}
\alias{AWRcca}
\title{Adaptive Wrapped Robust Canonical Correlation Analysis (AWRcca)}
\usage{
AWRcca(X, Y, b = 1.5, c = 4, alpha = 0.975, n_xi = 10000, lambda_cap = 0.5)
}
\arguments{
\item{X}{A numeric matrix of dimension \eqn{n \times p}.}

\item{Y}{A numeric matrix of dimension \eqn{n \times q}.}

\item{b}{Lower wrapping threshold (\eqn{b < c}). Default is 1.5.}

\item{c}{Upper wrapping threshold. Default is 4.}

\item{alpha}{Reweighting cutoff probability for chi-square threshold. Default is 0.975.}

\item{n_xi}{Monte Carlo sample size for the consistency correction. Default is 10000.}

\item{lambda_cap}{Upper bound for the shrinkage intensity. Default is 0.5.}
}
\value{
A list with components:
\itemize{
  \item \code{cor}: vector of canonical correlations.
  \item \code{shrink_used}: shrinkage intensity used in the correlation regularization.
  \item \code{weights}: 0/1 weights from MCD-based reweighting in score space.
  \item \code{u1}: first canonical score for \code{X} (initial solution).
  \item \code{v1}: first canonical score for \code{Y} (initial solution).
}
}
\description{
Implements an adaptive wrapped robust canonical correlation analysis procedure for
potentially contaminated high-dimensional data. The method applies columnwise robust
standardization and wrapping to mitigate cellwise outliers, uses a Fisher-consistency
correction, enforces positive semi-definiteness of the correlation matrix, applies
Ledoit--Wolf type shrinkage, and performs an MCD-based reweighting in the canonical
score space to downweight casewise outliers.
}
\details{
The wrapping transformation is based on a smooth redescending function
\eqn{\psi_{b,c}} applied to robust z-scores (median/MAD). The shrinkage intensity is
estimated in a Ledoit--Wolf spirit and then capped by \code{lambda_cap} to avoid
overshrinkage.

The function returns (i) canonical correlations, (ii) the shrinkage intensity used,
(iii) 0/1 reweighting indicators, and (iv) the first canonical score pair computed from
the initial solution (useful for diagnostic plots).
}
\examples{
# Example: correlated blocks via a shared latent factor
set.seed(123)
n <- 50; p <- 30; q <- 20
u <- rnorm(n)
ax <- rnorm(p); ax <- ax / sqrt(sum(ax^2))
by <- rnorm(q); by <- by / sqrt(sum(by^2))
X <- 1.0 * u \%*\% t(ax) + matrix(rnorm(n*p), n, p)
Y <- 1.0 * u \%*\% t(by) + matrix(rnorm(n*q), n, q)
fit <- AWRcca(X, Y)
fit$cor[1]

}
